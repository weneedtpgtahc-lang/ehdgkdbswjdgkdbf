<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>스네이크 | 노트북 전용 최소 구성</title>
  <style>
    html,body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{max-width:440px;margin:0 auto;padding:12px}
    h1{font-size:18px;margin:8px 0}
    canvas{display:block;background:#111;image-rendering:pixelated}
    .row{display:flex;gap:12px;align-items:center;margin-top:6px}
    small{color:#555}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>스네이크</h1>
    <canvas id="c" width="400" height="400" aria-label="스네이크 게임"></canvas>
    <div class="row">
      <div>점수: <span id="score">0</span></div>
      <small>조작: ↑ ↓ ← → / R 재시작</small>
    </div>
  </div>

  <script>
    // 노트북 전용: 화살표 키 입력. 페이지 스크롤 방지.
    const cvs = document.getElementById('c');
    const ctx = cvs.getContext('2d');
    const N = 20;                 // 20x20 그리드
    const S = cvs.width / N;      // 셀 크기
    const scoreEl = document.getElementById('score');

    let snake, dir, nextDir, food, score, last, stepMs;

    function spawnFood(){
      while(true){
        const f = { x: (Math.random()*N)|0, y: (Math.random()*N)|0 };
        if(!snake.some(s=>s.x===f.x && s.y===f.y)) return f;
      }
    }

    function reset(){
      snake = [{x:10,y:10},{x:9,y:10},{x:8,y:10}];
      dir = {x:1,y:0};
      nextDir = {x:1,y:0};
      food = spawnFood();
      score = 0; scoreEl.textContent = score;
      stepMs = 110; last = 0;
    }

    addEventListener('keydown', e => {
      if (['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].includes(e.key)) e.preventDefault();
      if(e.key==='ArrowUp'   && dir.y!== 1) nextDir={x:0,y:-1};
      if(e.key==='ArrowDown' && dir.y!==-1) nextDir={x:0,y: 1};
      if(e.key==='ArrowLeft' && dir.x!== 1) nextDir={x:-1,y:0};
      if(e.key==='ArrowRight'&& dir.x!==-1) nextDir={x: 1,y:0};
      if(e.key==='r' || e.key==='R') reset();
    }, {passive:false});

    function step(){
      dir = nextDir;
      const head = {x:(snake[0].x+dir.x+N)%N, y:(snake[0].y+dir.y+N)%N};
      if(snake.some(s=>s.x===head.x && s.y===head.y)){ reset(); return; }
      snake.unshift(head);
      if(head.x===food.x && head.y===food.y){
        score++; scoreEl.textContent = score;
        food = spawnFood();
      } else snake.pop();
    }

    function draw(){
      ctx.clearRect(0,0,cvs.width,cvs.height);
      ctx.fillStyle = '#f90'; // 먹이
      ctx.fillRect(food.x*S, food.y*S, S, S);
      ctx.fillStyle = '#0f8'; // 뱀
      for(const p of snake) ctx.fillRect(p.x*S+1, p.y*S+1, S-2, S-2);
    }

    function loop(t){
      if(!last) last = t;
      if(t - last >= stepMs){ step(); draw(); last = t; }
      requestAnimationFrame(loop);
    }

    reset();
    requestAnimationFrame(loop);
  </script>
</body>
</html>
